---
// HeroTitle.astro - Componente para el título y badge del hero
import Badge from '@components/ui/Badge.astro';
import TextPressureWrapper from '@components/TextPressureWrapper.astro';

interface Props {
  title: string;
  badgeText: string;
  darkMode?: boolean;
}

const { title, badgeText, darkMode = false } = Astro.props;

// Obtenemos la información de la empresa activa
import { getActiveSiteData } from '../../utils/experienceUtils';
const { companyUrl, companyLogo, companyName } = getActiveSiteData();
---

<div class='typing-container flex flex-col-reverse gap-y-6 md:gap-y-0 md:flex-row md:gap-x-6 lg:gap-x-8 pb-2 lg:pb-3 md:items-start'>
  <div class='typing mx-auto md:mx-0 md:min-w-[320px]'>
    <TextPressureWrapper 
      text={title} 
      darkMode={darkMode} 
      className="md:min-h-[100px] lg:min-h-[120px]"
    />
  </div>

  <div class='flex justify-center md:pt-2 lg:pt-4 md:self-start text-nowrap'>
    <a
      href={companyUrl}
      target='_blank'
      rel='noopener'
      class='flex justify-center items-center'
    >
      <Badge class="pulsating p-2.5 md:p-3">
        {companyLogo && (
          <img 
            src={companyLogo} 
            alt={`${companyName} logo`} 
            class="w-16 h-16 md:w-24 md:h-24 lg:w-28 lg:h-28"
          />
        )}
      </Badge>
    </a>
  </div>
</div>

<script>
  import { gsap } from 'gsap';
  
  document.addEventListener('DOMContentLoaded', () => {
    // Asegurar que las animaciones estén habilitadas por defecto
    if (localStorage.getItem('enable-animations') === null) {
      localStorage.setItem('enable-animations', 'true');
    }
    
    // Asegurar que la clase reduce-motion no esté aplicada si las animaciones están habilitadas
    if (localStorage.getItem('enable-animations') === 'true') {
      document.documentElement.classList.remove('reduce-motion');
    }
    
    // Animar la aparición del badge
    const badgeElement = document.querySelector('.pulsating');
    if (badgeElement) {
      gsap.set(badgeElement, {
        opacity: 0,
        y: 5
      });
      
      gsap.to(badgeElement, {
        opacity: 1,
        y: 0,
        duration: 0.3,
        ease: "power2.out",
        delay: 0.3,
        onComplete: () => {
          gsap.to(badgeElement, {
            scale: 1.05,
            duration: 1.2,
            repeat: -1,
            yoyo: true,
            ease: "sine.inOut"
          });
        }
      });
    }
  });
</script>
