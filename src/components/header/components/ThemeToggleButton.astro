---
import SunIcon from '@icons/Sun.astro';
import MoonIcon from '@icons/Moon.astro';
import SystemIcon from '@icons/System.astro';
import ThemeMenu from './ThemeMenu.astro';

const themes = [
  { id: 'light', name: 'Claro', icon: SunIcon },
  { id: 'dark', name: 'Oscuro', icon: MoonIcon },
  { id: 'system', name: 'Sistema', icon: SystemIcon }
];
---

<div class='relative'>
  <button
    id='theme-toggle-btn'
    class='appearance-none border-none flex hover:scale-110 active:scale-95 transition-all duration-200 p-1 rounded-lg'
    aria-label='Cambiar tema'
  >
    <span class='sr-only'>Elige el tema</span>
    <SunIcon id='light' class='theme-toggle-icon size-[20px] text-amber-500' />
    <MoonIcon
      id='dark'
      class='theme-toggle-icon absolute size-[20px] text-indigo-500'
    />
    <SystemIcon
      id='system'
      class='theme-toggle-icon absolute size-[20px] text-gray-600 dark:text-gray-400'
    />
  </button>
  <ThemeMenu themes={themes} />
</div>

<style>
  /* Estilo Apple para los toggles */
  .theme-toggle-icon {
    transition: opacity 300ms cubic-bezier(0.4, 0, 0.2, 1), transform 300ms cubic-bezier(0.4, 0, 0.2, 1), scale 300ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  #theme-toggle-btn {
    position: relative;
  }

  #light {
    scale: 1;
  }

  #dark, #system {
    scale: 0;
  }

  :global(.dark) #light {
    scale: 0;
  }

  :global(.dark) #dark {
    scale: 1;
  }

  :global(.system) #light, :global(.system) #dark {
    scale: 0;
  }

  :global(.system) #system {
    scale: 1;
  }
  
  /* Animaci√≥n avanzada para los iconos en hover */
  #theme-toggle-btn:hover .theme-toggle-icon {
    transform: scale(1.2) rotate(8deg);
    filter: brightness(1.2);
    transition: transform 0.25s cubic-bezier(0.34, 1.56, 0.64, 1), filter 0.25s ease;
  }
  
  /* Efecto pulse en active para los botones del header */
  #theme-toggle-btn:active .theme-toggle-icon {
    transform: scale(0.9);
    transition: transform 0.15s ease-out;
  }
</style>