---
import ArrowUp from '@icons/ArrowUp.astro';
import type { Translations } from '@types/translations';
import type { FooterItem } from '@types/footerItem';
import LocationTextFooter from '@components/ui/Map/LocationTextFooter.astro';
import LegalFooter from '@components/legal/LegalFooter.astro';

const translations: Translations = Astro.props.translations;
const footerItems: FooterItem[] = translations.footerItems;

// Configuraci칩n para la ubicaci칩n tal como est치 en el Hero
const currentUrl = Astro.url.pathname;
const isEnglish = currentUrl.includes('/en');
const visibleLocationText = "M치laga, Espa침a";
const visibleLocationTextEN = "Malaga, Spain";
const displayLocationText = isEnglish ? visibleLocationTextEN : visibleLocationText;

// Obtener informaci칩n completa de la ubicaci칩n
const fullLocation = translations.personalInfo.location;
---

<footer class='shadow p-4 py-8 md:p-8 lg:p-10 backdrop-blur-[1px]'>
	<div class='mx-auto max-w-screen-xl text-center'>
		<a
			href='https://www.linkedin.com/in/francisco-jos%C3%A9-r-5b2181bb/'
			class='flex justify-center items-center text-2xl font-semibold text-gray-700 dark:text-white'
			target='_blank'
			rel='noopener noreferrer'
		>
			<img src='/favicon.png' class='rounded-full w-10 h-10 mr-4' />
			{translations.personalInfo.alias}
		</a>
		<div class='my-6 text-gray-500 dark:text-gray-400'>
			{translations.personalInfo.role}
			<div class="inline-flex justify-center mt-2">
				<LocationTextFooter
					text={displayLocationText}
					city="M치laga"
					region="Andaluc칤a"
					address={fullLocation}
					className="text-red-500 dark:text-red-200/95 text-nowrap"
				/>
			</div>
		</div>
		
		<!-- Enlaces de navegaci칩n -->
		<ul
			class='flex flex-wrap gap-y-2 md:gap-y-0 justify-center items-center mb-6 text-gray-700 dark:text-white/80'
		>
			<li>
				<a
					href={footerItems[0].url}
					class='mr-4 hover:underline md:mr-6'
				>
					{footerItems[0].title}
				</a>
			</li>
			<li>
				<a
					href={footerItems[1].url}
					class='mr-4 hover:underline md:mr-6'
				>
					{footerItems[1].title}
				</a>
			</li>
			<li>
				<a
					href={footerItems[2].url}
					class='mr-4 hover:underline md:mr-6'
				>
					{footerItems[2].title}
				</a>
			</li>
			<li>
				<a
					href={footerItems[3].url}
					class='mr-4 hover:underline md:mr-6'
				>
					{footerItems[3].title}
				</a>
			</li>
			<li>
				<a
					href={footerItems[4].url}
					target='_blank'
					rel='noopener noreferrer'
					class='hover:underline md:mr-6 mr-4'
				>
					{footerItems[4].title}
				</a>
			</li>
			<li>
				<a
					href={footerItems[5].url}
					class='hover:underline flex flex-row items-center justify-center group gap-[2px]'
					>{footerItems[5].title}
					<ArrowUp
						class='size-4 group-hover:-translate-y-[1px] transition-all'
					/></a
				>
			</li>
		</ul>
		
		<!-- Enlaces legales -->
		<div class="mt-4 mb-3">
			<LegalFooter />
		</div>
		
		<!-- Copyright -->
		<span class="text-sm text-gray-500 sm:text-center dark:text-gray-400">
			춸 2024{' '}
			<div class="footer-profile-wrapper inline-block relative">
				<a href='#' class="hover:underline text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white transition-colors duration-200">
					{translations.personalInfo.name}
				</a>
				<div class="footer-tooltip-container">
					<div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 p-4 tooltip-content">
						<div class="flex items-center space-x-4 mb-3">
							<div class="w-12 h-12 xs:w-14 xs:h-14 sm:w-16 sm:h-16 flex-shrink-0 rounded-full overflow-hidden bg-gray-200 dark:bg-gray-700 ring-2 ring-primary/20 animate-scale-up">
								<img
									src='/assets/images/Fr4n0m Photo.webp'
									alt='Fr4n0m photo'
									class="w-full h-full object-cover"
									style="aspect-ratio: 1/1; object-position: center;"
								/>
							</div>
							<div>
								<h3 class="font-bold text-base xs:text-lg dark:text-white">{translations.personalInfo.name}</h3>
								<p class="text-xs xs:text-sm text-gray-600 dark:text-gray-400">{translations.personalInfo.role}</p>
							</div>
						</div>
						<div class="space-y-2 text-xs xs:text-sm">
							<div class="flex items-center space-x-2">
								<!-- SF Symbol envelope.fill de Apple -->
								<svg class="w-3 h-3 xs:w-4 xs:h-4 text-gray-500" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
									<path 
										d="M18.6,21.5H5.4c-1.6,0-3-1.3-3-3V7.1l8.6,5.3c0.3,0.1,0.6,0.2,0.9,0.2s0.7-0.1,0.9-0.2L21.5,7v11.5C21.5,20.1,20.2,21.5,18.6,21.5z" 
										fill="currentColor"
									/>
									<path 
										d="M21.5,5.8v-0.2c0-1.6-1.3-3-3-3H5.4c-1.6,0-3,1.3-3,3v0.3l9.2,5.7c0.1,0.1,0.3,0.1,0.4,0.1s0.3,0,0.4-0.1L21.5,5.8z" 
										fill="currentColor"
									/>
								</svg>
								<span class="text-gray-700 dark:text-gray-300 truncate">{translations.personalInfo.mail}</span>
							</div>
							<div class="flex items-center space-x-2">
								<!-- SF Symbol mappin.circle.fill de Apple -->
								<svg class="w-3 h-3 xs:w-4 xs:h-4 text-gray-500" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
									<path 
										d="M12,2C6.5,2,2,6.5,2,12s4.5,10,10,10s10-4.5,10-10S17.5,2,12,2z M12,17c-0.4,0-0.7-0.3-1-0.6l-2.5-5.7c-0.3-0.7,0-1.5,0.7-1.7c0.2-0.1,0.3-0.1,0.5-0.1h4.6c0.7,0,1.3,0.6,1.3,1.3c0,0.2,0,0.3-0.1,0.5l-2.5,5.7C12.7,16.7,12.4,17,12,17z" 
										fill="currentColor"
									/>
									<circle 
										cx="12" 
										cy="10" 
										r="1.5" 
										fill="white"
									/>
								</svg>
								<span class="text-gray-700 dark:text-gray-300">
									{translations.personalInfo.location.replace(/^游늸\s*/, '')}
								</span>
							</div>
							<div class="flex items-center space-x-2">
								<!-- SF Symbol server.rack de Apple -->
								<svg class="w-3 h-3 xs:w-4 xs:h-4 text-gray-500" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
									<rect x="3" y="4" width="18" height="4" rx="1" fill="currentColor"/>
									<rect x="3" y="10" width="18" height="4" rx="1" fill="currentColor"/>
									<rect x="3" y="16" width="18" height="4" rx="1" fill="currentColor"/>
									<circle cx="6" cy="6" r="0.5" fill="white"/>
									<circle cx="6" cy="12" r="0.5" fill="white"/>
									<circle cx="6" cy="18" r="0.5" fill="white"/>
								</svg>
								<span class="text-gray-700 dark:text-gray-300 specialties-text">React, Next.js, Node.js, Astro, TypeScript</span>
							</div>
							<div class="flex items-center space-x-2">
								<!-- SF Symbol gearshape.2.fill de Apple -->
								<svg class="w-3 h-3 xs:w-4 xs:h-4 text-gray-500" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
									<path 
										d="M9.6,22H7.4c-0.7,0-1.2-0.5-1.4-1.1l-0.4-1.5c-0.3-0.1-0.6-0.3-0.9-0.4l-1.4,0.6c-0.6,0.3-1.3,0-1.7-0.6l-1.1-1.9c-0.3-0.6-0.1-1.3,0.4-1.7l1.2-1C2,14,2,13.7,2,13.4s0-0.6,0.1-0.9l-1.2-1c-0.5-0.4-0.7-1.1-0.4-1.7l1-1.9c0.3-0.6,1.1-0.9,1.7-0.6l1.4,0.6c0.3-0.2,0.6-0.3,0.9-0.4l0.4-1.5C6.1,5.5,6.7,5,7.4,5h2.2c0.7,0,1.2,0.5,1.4,1.1l0.4,1.5c0.3,0.1,0.6,0.3,0.9,0.4l1.4-0.6c0.6-0.3,1.3,0,1.7,0.6l1.1,1.9c0.3,0.6,0.1,1.3-0.4,1.7l-1.2,1c0.1,0.3,0.1,0.6,0.1,0.9s0,0.6-0.1,0.9l1.2,1c0.5,0.4,0.7,1.1,0.4,1.7l-1.1,1.9c-0.3,0.6-1.1,0.9-1.7,0.6l-1.4-0.6c-0.3,0.2-0.6,0.3-0.9,0.4l-0.4,1.5C10.9,21.5,10.3,22,9.6,22z" 
										fill="currentColor"
									/>
									<path 
										d="M22,8.5c0-0.2,0-0.4-0.1-0.6l0.8-0.7c0.3-0.3,0.4-0.7,0.2-1l-0.6-1.1c-0.2-0.4-0.6-0.5-1-0.4l-0.9,0.4c-0.2-0.1-0.4-0.2-0.6-0.3l-0.3-1c-0.1-0.4-0.5-0.7-0.9-0.7h-1.3c-0.4,0-0.8,0.3-0.9,0.7l-0.3,1c-0.2,0.1-0.4,0.2-0.6,0.3L15,4.8c-0.4-0.2-0.8,0-1,0.4L13.4,6.2c-0.2,0.4-0.1,0.8,0.2,1l0.8,0.7c0,0.2-0.1,0.4-0.1,0.6s0,0.4,0.1,0.6l-0.8,0.7c-0.3,0.3-0.4,0.7-0.2,1l0.6,1.1c0.2,0.4,0.6,0.5,1,0.4l0.9-0.4c0.2,0.1,0.4,0.2,0.6,0.3l0.3,1c0.1,0.4,0.5,0.7,0.9,0.7H19c0.4,0,0.8-0.3,0.9-0.7l0.3-1c0.2-0.1,0.4-0.2,0.6-0.3l0.9,0.4c0.4,0.2,0.8,0,1-0.4l0.6-1.1c0.2-0.4,0.1-0.8-0.2-1L22.1,9.1C22,8.9,22,8.7,22,8.5z" 
										fill="currentColor"
									/>
									<circle cx="8.5" cy="13.5" r="2" fill="white"/>
									<circle cx="18.5" cy="8.5" r="1.25" fill="white"/>
								</svg>
								<span class="text-gray-700 dark:text-gray-300 tech-text">Tailwind CSS, MongoDB, PostgreSQL, Git</span>
							</div>
						</div>
						<div class="arrow absolute w-4 h-4 bg-white dark:bg-gray-800 border-l border-t border-gray-200 dark:border-gray-700 transform rotate-45"></div>
					</div>
				</div>
			</div>
		</span>
	</div>
</footer>

<style>
	/* Aseguramos que el LocationText est칠 correctamente centrado cuando est치 en l칤nea */
	.inline-flex {
		display: inline-flex;
	}
	
	/* Estilos para el tooltip del footer */
	.footer-profile-wrapper {
		cursor: pointer;
		z-index: 10;
	}

	.footer-tooltip-container {
		position: absolute;
		bottom: 100%;
		left: 50%;
		transform: translateX(-50%);
		margin-bottom: 1rem;
		opacity: 0;
		visibility: hidden;
		transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
		z-index: 40;
		pointer-events: none;
		width: min(90vw, 320px);
		transform: translateX(-50%) translateY(5px);
	}
	
	.footer-profile-wrapper:hover .footer-tooltip-container {
		opacity: 1;
		visibility: visible;
		pointer-events: auto;
		transform: translateX(-50%) translateY(0);
	}
	
	/* Contenido del tooltip */
	.tooltip-content {
		width: 100%;
		max-width: 100%;
		min-width: 250px;
		font-size: 0.875rem;
	}
	
	/* Flecha del tooltip */
	.arrow {
		bottom: -0.5rem;
		left: 50%;
		transform: translateX(-50%) rotate(225deg);
	}

	/* Truncar textos largos */
	.specialties-text,
	.tech-text {
		display: inline-block;
		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
		max-width: calc(100% - 2rem);
	}
	
	/* Animaci칩n para la imagen */
	@keyframes scale-up {
		0% {
			transform: scale(0.8);
			opacity: 0;
		}
		100% {
			transform: scale(1);
			opacity: 1;
		}
	}

	.animate-scale-up {
		animation: scale-up 0.3s ease-out forwards;
	}

	/* Adaptaci칩n para m칩viles */
	@media (max-width: 640px) {
		.footer-tooltip-container {
			max-width: 280px;
		}
		
		.tooltip-content {
			padding: 0.75rem;
			font-size: 0.75rem;
		}
		
		.tech-text, .specialties-text {
			max-width: 170px;
		}
	}
</style>
